muzzle {
}

apply from: "${rootDir}/gradle/java.gradle"

task "rmic", dependsOn: testClasses {
  def clazz = 'rmi.app.ServerLegacy'
  String command = """rmic -g -keep -classpath ${sourceSets.test.output.classesDirs.asPath} -d ${buildDir}/classes/java/test ${clazz}"""
  command.execute().text
}

// TODO:
task "compileContextServerStub", dependsOn: testClasses {
  def clazz = 'datadog.trace.instrumentation.rmi.context.ContextServer'
  String command = """rmic -g -keep -classpath ${sourceSets.main.output.classesDirs.asPath} -d ${buildDir}/classes/java/main ${clazz}"""
  println command.execute().text
}

test.dependsOn "rmic"
